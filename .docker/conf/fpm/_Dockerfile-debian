FROM php:7.3-fpm
#Debian 10 (Buster)
#https://www.itzgeek.com/how-tos/linux/debian/how-to-install-php-7-3-7-2-7-1-on-debian-10-debian-9-debian-8.html
#https://computingforgeeks.com/how-to-install-latest-php-on-debian/

# Fix debconf warnings upon build
ARG DEBIAN_FRONTEND=noninteractive

RUN apt-get update && apt-get install -y gnupg wget git zip && apt-get update

# UPDATE
RUN apt -y install lsb-release apt-transport-https ca-certificates
RUN wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg 
RUN echo "deb https://packages.sury.org/php/ $(lsb_release -sc) main" | tee /etc/apt/sources.list.d/php.list
RUN apt update




# Show all repo
#grep ^ /etc/apt/sources.list /etc/apt/sources.list.d/*

# for curl

#pear-channels phing composer
RUN apt-add-repository ppa:ondrej/php

#for add-apt-repository
RUN apt-get -y install software-properties-common && apt-get update
# apt list --installed

# get php
#RUN echo "deb http://ppa.launchpad.net/ondrej/php/ubuntu bionic main" > /etc/apt/sources.list.d/ondrej-php.list 
#RUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4F4EA0AAE5267A6C 

# pecl
#pecl channel-update pecl.php.net
#pecl install phalcon

# Install phalcon with apt-get
RUN curl -s https://packagecloud.io/install/repositories/phalcon/stable/script.deb.sh | bash
RUN apt-get install -y php7-phalcon

# apt-get
#RUN apt-get install -y php-pear php7-dev php-ds php7.4-intl sqlite3 phpldapadmin
#pear-channels phing

# clean
RUN rm -rf /var/lib/apt/lists/*

# Pecl
RUN pecl channel-update pecl.php.net
#RUN pecl install ds phalcon

# composer
#RUN wget https://raw.githubusercontent.com/composer/getcomposer.org/76a7060ccb93902cd7576b67264ad91c8a2700e2/web/installer -O - -q | php -- --quiet
RUN wget https://getcomposer.org/installer && php ./installer
RUN mv ./composer.phar /usr/local/bin/composer 

# set version
#RUN update-alternatives --set php /usr/bin/php7.3 